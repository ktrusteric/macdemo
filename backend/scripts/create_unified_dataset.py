#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
åˆ›å»ºç»Ÿä¸€çš„ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒä¿¡æ¯é—¨æˆ·ç³»ç»Ÿæ•°æ®é›†
ä»å¤šä¸ªJSONæ–‡ä»¶åˆå¹¶æ•°æ®ï¼Œåˆ›å»ºåŒ…å«å®Œæ•´æ ‡ç­¾ä¿¡æ¯çš„ç»Ÿä¸€æ•°æ®é›†
"""

import sys
import os
import json
from datetime import datetime

def load_v1_articles():
    """åŠ è½½v1ç‰ˆæœ¬çš„45ç¯‡æ–‡ç« """
    json_file_path = os.path.join(os.path.dirname(__file__), 'ä¿¡æ¯å‘å¸ƒæ–‡ç« ä¸æ ‡ç­¾_è§„èŒƒåŒ–.json')
    try:
        with open(json_file_path, 'r', encoding='utf-8') as f:
            v1_articles = json.load(f)
        print(f"âœ… åŠ è½½v1ç‰ˆæœ¬æ–‡ç« : {len(v1_articles)}ç¯‡")
        return v1_articles
    except Exception as e:
        print(f"âŒ åŠ è½½v1æ–‡ç« å¤±è´¥: {e}")
        return []

def get_v2_additional_articles():
    """è·å–v2ç‰ˆæœ¬çš„6ç¯‡é¢å¤–æ–‡ç« """
    v2_articles = [
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-30",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-30",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "å¯†é›†æŠ•äº§æ½®ä¸‹åˆ©ç”¨ç‡ä¸è¶³50%ï¼ŒLNGæ¥æ”¶ç«™å¸‚åœºç«äº‰åŠ å‰§ï¼Œå¦‚ä½•ä¿éšœæ•ˆç›Š",
            "æ–‡ç« å†…å®¹": "éšç€å…¨çƒLNGè´¸æ˜“é‡æŒç»­å¢é•¿ï¼Œä¸­å›½LNGæ¥æ”¶ç«™å»ºè®¾è¿›å…¥å¯†é›†æŠ•äº§æœŸã€‚ç„¶è€Œï¼Œå—å¸‚åœºä¾›éœ€å˜åŒ–å½±å“ï¼Œéƒ¨åˆ†æ¥æ”¶ç«™åˆ©ç”¨ç‡ä¸è¶³50%ï¼Œé¢ä¸´ä¸¥å³»çš„å¸‚åœºç«äº‰å‹åŠ›ã€‚è¡Œä¸šä¸“å®¶æŒ‡å‡ºï¼Œæ¥æ”¶ç«™è¿è¥å•†éœ€è¦é€šè¿‡æŠ€æœ¯å‡çº§ã€æœåŠ¡ä¼˜åŒ–ã€å•†ä¸šæ¨¡å¼åˆ›æ–°ç­‰æ–¹å¼æå‡ç«äº‰åŠ›ï¼Œç¡®ä¿æŠ•èµ„æ•ˆç›Šã€‚æœªæ¥LNGæ¥æ”¶ç«™å‘å±•éœ€è¦ç»Ÿç­¹è§„åˆ’ï¼Œé¿å…é‡å¤å»ºè®¾ï¼Œæé«˜æ•´ä½“åˆ©ç”¨æ•ˆç‡ã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250530/7850.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['å…¨å›½']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['æ¥æ”¶ç«™è¿è¥', 'å¸‚åœºç«äº‰']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['LNGè¿è¥å•†', 'èƒ½æºä¼ä¸š']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['æŠ€æœ¯å‡çº§', 'å•†ä¸šæ¨¡å¼åˆ›æ–°']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['è¡Œä¸šçº§']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["ä¸­å›½", "å…¨å›½"]
        },
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-30",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-30",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "æ–°å¥¥è‚¡ä»½é‡å¤§èµ„äº§é‡ç»„è·è‚¡ä¸œå¤§ä¼šè¶…99.9%é«˜ç¥¨é€šè¿‡ï¼Œå¤©ç„¶æ°”äº§ä¸šé“¾ä¸€ä½“åŒ–æˆ˜ç•¥å–å¾—å…³é”®è¿›å±•",
            "æ–‡ç« å†…å®¹": "æ–°å¥¥è‚¡ä»½é‡å¤§èµ„äº§é‡ç»„æ–¹æ¡ˆè·å¾—è‚¡ä¸œå¤§ä¼šè¶…99.9%çš„é«˜ç¥¨é€šè¿‡ï¼Œæ ‡å¿—ç€å…¬å¸å¤©ç„¶æ°”äº§ä¸šé“¾ä¸€ä½“åŒ–æˆ˜ç•¥å–å¾—å…³é”®æ€§è¿›å±•ã€‚æ­¤æ¬¡é‡ç»„å°†è¿›ä¸€æ­¥å®Œå–„æ–°å¥¥åœ¨å¤©ç„¶æ°”å…¨äº§ä¸šé“¾çš„å¸ƒå±€ï¼Œæå‡å…¬å¸åœ¨LNGè´¸æ˜“ã€ç»ˆç«¯é”€å”®ç­‰å…³é”®ç¯èŠ‚çš„ç«äº‰ä¼˜åŠ¿ã€‚å¸‚åœºåˆ†æè®¤ä¸ºï¼Œè¿™ä¸€ä¸¾æªå°†æœ‰åŠ©äºæ–°å¥¥è‚¡ä»½å®ç°è§„æ¨¡åŒ–å‘å±•ï¼Œæé«˜æŠ—é£é™©èƒ½åŠ›ã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250530/7849.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['å…¨å›½']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["å¤©ç„¶æ°”", "æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['èµ„äº§é‡ç»„', 'äº§ä¸šé“¾ä¸€ä½“åŒ–']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['æ–°å¥¥è‚¡ä»½', 'ä¸Šå¸‚å…¬å¸']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['èµ„äº§é‡ç»„', 'äº§ä¸šé“¾æ•´åˆ']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['è¡Œä¸šçº§']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["ä¸­å›½", "å…¨å›½"]
        },
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-30",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-30",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "ä¸­å›½çŸ³æ²¹å‘å¸ƒ3000äº¿å‚æ•°æ˜†ä»‘å¤§æ¨¡å‹",
            "æ–‡ç« å†…å®¹": "ä¸­å›½çŸ³æ²¹æ­£å¼å‘å¸ƒ3000äº¿å‚æ•°è§„æ¨¡çš„æ˜†ä»‘å¤§æ¨¡å‹ï¼Œè¿™æ˜¯çŸ³æ²¹å¤©ç„¶æ°”è¡Œä¸šé¦–ä¸ªåƒäº¿çº§å‚æ•°å¤§æ¨¡å‹ã€‚è¯¥æ¨¡å‹å°†åœ¨å‹˜æ¢å¼€å‘ã€ç‚¼åŒ–ç”Ÿäº§ã€é”€å”®æœåŠ¡ç­‰å¤šä¸ªä¸šåŠ¡åœºæ™¯ä¸­åº”ç”¨ï¼Œé€šè¿‡AIæŠ€æœ¯æå‡ä½œä¸šæ•ˆç‡å’Œå†³ç­–æ°´å¹³ã€‚ä¸“å®¶è¡¨ç¤ºï¼Œå¤§æ¨¡å‹æŠ€æœ¯çš„åº”ç”¨å°†æ¨åŠ¨ä¼ ç»Ÿèƒ½æºè¡Œä¸šæ•°å­—åŒ–è½¬å‹ï¼Œä¸ºè¡Œä¸šå‘å±•æ³¨å…¥æ–°åŠ¨èƒ½ã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250530/7848.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['å…¨å›½']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["åŸæ²¹", "å¤©ç„¶æ°”"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['äººå·¥æ™ºèƒ½', 'æ•°å­—åŒ–è½¬å‹']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['ä¸­å›½çŸ³æ²¹', 'èƒ½æºä¼ä¸š']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['æŠ€æœ¯åˆ›æ–°', 'AIåº”ç”¨']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['è¡Œä¸šçº§', 'æŠ€æœ¯çªç ´']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["ä¸­å›½", "å…¨å›½"]
        },
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-29",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-29",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "5æœˆ19æ—¥-25æ—¥ä¸­å›½LNGç»¼åˆè¿›å£åˆ°å²¸ä»·æ ¼æŒ‡æ•°ä¸º131.78ç‚¹",
            "æ–‡ç« å†…å®¹": "5æœˆ19æ—¥-25æ—¥å½“å‘¨ï¼Œä¸­å›½LNGç»¼åˆè¿›å£åˆ°å²¸ä»·æ ¼æŒ‡æ•°ä¸º131.78ç‚¹ï¼Œä»·æ ¼ç›¸å¯¹ç¨³å®šã€‚éšç€å¤å­£ç”¨æ°”éœ€æ±‚é€æ­¥å‡å°‘ï¼ŒLNGå¸‚åœºä¾›éœ€è¶‹äºå¹³è¡¡ã€‚ä¸šå†…åˆ†æè®¤ä¸ºï¼ŒäºŒå­£åº¦LNGä»·æ ¼å°†ä¿æŒç›¸å¯¹å¹³ç¨³ï¼Œä½†éœ€å…³æ³¨å›½é™…å¸‚åœºä¾›åº”ç«¯å˜åŒ–å’Œä¸‹åŠå¹´å†¬å­£å¤‡è´§éœ€æ±‚ã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250529/7845.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['å…¨å›½']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['ä»·æ ¼æŒ‡æ•°', 'è¿›å£è´¸æ˜“']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['LNGè´¸æ˜“å•†', 'åŸå¸‚ç‡ƒæ°”å…¬å¸']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['ä»·æ ¼ç›‘æµ‹', 'ä¾›éœ€è°ƒèŠ‚']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['å¸‚åœºçº§']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["ä¸­å›½", "å…¨å›½"]
        },
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-29",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-29",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "å¤§æ¸¯æ²¹ç”°å‚¨æ°”åº“ç¾¤åŠ å¿«æ‰©å®¹ ä¸ºäº¬æ´¥å†€å†¬å­£ä¿ä¾›è“„èƒ½",
            "æ–‡ç« å†…å®¹": "å¤§æ¸¯æ²¹ç”°å‚¨æ°”åº“ç¾¤æ­£åœ¨åŠ å¿«æ‰©å®¹å»ºè®¾ï¼Œä¸ºå³å°†åˆ°æ¥çš„å†¬å­£å¤©ç„¶æ°”ä¿ä¾›åšå¥½å‡†å¤‡ã€‚ä½œä¸ºååŒ—åœ°åŒºé‡è¦çš„å¤©ç„¶æ°”å‚¨å¤‡åŸºåœ°ï¼Œå¤§æ¸¯å‚¨æ°”åº“ç¾¤æ‰¿æ‹…ç€äº¬æ´¥å†€åœ°åŒºå†¬å­£è°ƒå³°ä¿ä¾›çš„é‡è¦ä»»åŠ¡ã€‚é¢„è®¡æ–°å¢å‚¨æ°”èƒ½åŠ›å°†æœ‰æ•ˆç¼“è§£å†¬å­£ç”¨æ°”ç´§å¼ å±€é¢ï¼Œä¸ºåŒºåŸŸèƒ½æºå®‰å…¨æä¾›åšå®ä¿éšœã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250529/7844.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['ååŒ—åœ°åŒº']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["å¤©ç„¶æ°”"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['å‚¨æ°”åº“', 'å†¬å­£ä¿ä¾›']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['äº¬æ´¥å†€ç”¨æˆ·', 'åŸå¸‚ç‡ƒæ°”å…¬å¸']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['å‚¨æ°”åº“å»ºè®¾', 'ä¿ä¾›æªæ–½']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['åŒºåŸŸçº§', 'æ°‘ç”Ÿä¿éšœ']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["åŒ—äº¬", "å¤©æ´¥", "æ²³åŒ—", "ååŒ—åœ°åŒº", "äº¬æ´¥å†€"]
        },
        {
            "å‘å¸ƒæ—¥æœŸ": "2025-05-28",
            "æ–‡æ¡£ç±»å‹": "è¡Œä¸šèµ„è®¯",
            "å‘å¸ƒæ—¶é—´": "2025-05-28",
            "æ¥æºæœºæ„": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
            "æ ‡é¢˜": "éæ´²æ¸æˆLNGä¾›åº”æ–°ä¸»åŠ›",
            "æ–‡ç« å†…å®¹": "éšç€å…¨çƒLNGéœ€æ±‚æŒç»­å¢é•¿ï¼Œéæ´²æ­£é€æ¸æˆä¸ºLNGä¾›åº”çš„æ–°ä¸»åŠ›ã€‚å°¼æ—¥åˆ©äºšã€è«æ¡‘æ¯”å…‹ã€å¦æ¡‘å°¼äºšç­‰éæ´²å›½å®¶æ‹¥æœ‰ä¸°å¯Œçš„å¤©ç„¶æ°”èµ„æºï¼Œæ­£åœ¨å¤§åŠ›å‘å±•LNGå‡ºå£é¡¹ç›®ã€‚åˆ†æå¸ˆé¢„è®¡ï¼Œæœªæ¥5å¹´éæ´²LNGäº§èƒ½å°†æ˜¾è‘—å¢é•¿ï¼Œä¸ºå…¨çƒLNGå¸‚åœºä¾›åº”å¤šå…ƒåŒ–åšå‡ºé‡è¦è´¡çŒ®ã€‚ä¸­å›½ä¼ä¸šä¹Ÿç§¯æå‚ä¸éæ´²LNGé¡¹ç›®å¼€å‘ã€‚",
            "é“¾æ¥": "https://www.shpgx.com/html/xyzx/20250528/7840.html",
            "åŸºç¡€ä¿¡æ¯æ ‡ç­¾": "['è¡Œä¸šèµ„è®¯']",
            "åœ°åŸŸæ ‡ç­¾": "['å›½é™…']",
            "èƒ½æºå“ç§æ ‡ç­¾": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)", "å¤©ç„¶æ°”"],
            "ä¸šåŠ¡é¢†åŸŸ/ä¸»é¢˜æ ‡ç­¾": "['LNGå‡ºå£', 'ä¾›åº”æ ¼å±€']",
            "å—ç›Šä¸»ä½“æ ‡ç­¾": "['éæ´²å›½å®¶', 'LNGç”Ÿäº§å•†']",
            "å…³é”®æªæ–½/æ”¿ç­–æ ‡ç­¾": "['èµ„æºå¼€å‘', 'å›½é™…åˆä½œ']",
            "é‡è¦æ€§/å½±å“åŠ›æ ‡ç­¾": "['å›½é™…çº§']",
            "è§„èŒƒåŒ–åœ°åŸŸæ ‡ç­¾": ["éæ´²", "å°¼æ—¥åˆ©äºš", "è«æ¡‘æ¯”å…‹", "å¦æ¡‘å°¼äºš", "å›½é™…"]
        }
    ]
    
    print(f"âœ… åŠ è½½v2ç‰ˆæœ¬é¢å¤–æ–‡ç« : {len(v2_articles)}ç¯‡")
    return v2_articles

def create_unified_dataset():
    """åˆ›å»ºç»Ÿä¸€çš„æ•°æ®é›†"""
    print("ğŸ”„ åˆ›å»ºç»Ÿä¸€çš„51ç¯‡æ–‡ç« æ•°æ®é›†...")
    print("=" * 60)
    
    # åŠ è½½v1ç‰ˆæœ¬æ–‡ç« 
    v1_articles = load_v1_articles()
    if not v1_articles:
        print("âŒ æ— æ³•åŠ è½½v1æ–‡ç« æ•°æ®")
        return False
    
    # è·å–v2ç‰ˆæœ¬é¢å¤–æ–‡ç« 
    v2_articles = get_v2_additional_articles()
    
    # åˆå¹¶æ•°æ®
    unified_articles = v1_articles + v2_articles
    
    print(f"\nğŸ“Š æ•°æ®åˆå¹¶ç»“æœ:")
    print(f"   v1ç‰ˆæœ¬æ–‡ç« : {len(v1_articles)}ç¯‡")
    print(f"   v2ç‰ˆæœ¬é¢å¤–æ–‡ç« : {len(v2_articles)}ç¯‡")
    print(f"   ç»Ÿä¸€æ•°æ®é›†æ€»è®¡: {len(unified_articles)}ç¯‡")
    
    # æ•°æ®è´¨é‡æ£€æŸ¥
    print(f"\nğŸ” æ•°æ®è´¨é‡æ£€æŸ¥:")
    titles = [article.get('æ ‡é¢˜', '') for article in unified_articles]
    unique_titles = set(titles)
    if len(titles) != len(unique_titles):
        print(f"   âš ï¸  å‘ç°é‡å¤æ ‡é¢˜: {len(titles) - len(unique_titles)}ä¸ª")
        duplicates = [title for title in titles if titles.count(title) > 1]
        for dup in set(duplicates):
            print(f"      é‡å¤æ ‡é¢˜: {dup}")
    else:
        print(f"   âœ… æ— é‡å¤æ ‡é¢˜")
    
    # æ£€æŸ¥å¿…è¦å­—æ®µ
    missing_fields = []
    for i, article in enumerate(unified_articles):
        required_fields = ['æ ‡é¢˜', 'æ–‡ç« å†…å®¹', 'åŸºç¡€ä¿¡æ¯æ ‡ç­¾', 'èƒ½æºå“ç§æ ‡ç­¾']
        for field in required_fields:
            if not article.get(field):
                missing_fields.append(f"æ–‡ç« {i+1}ç¼ºå°‘{field}")
    
    if missing_fields:
        print(f"   âš ï¸  å‘ç°ç¼ºå°‘å­—æ®µ: {len(missing_fields)}ä¸ª")
        for missing in missing_fields[:5]:  # åªæ˜¾ç¤ºå‰5ä¸ª
            print(f"      {missing}")
    else:
        print(f"   âœ… æ‰€æœ‰å¿…è¦å­—æ®µå®Œæ•´")
    
    # ä¿å­˜ç»Ÿä¸€æ•°æ®é›†
    output_file = os.path.join(os.path.dirname(__file__), 'ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒä¿¡æ¯é—¨æˆ·ç³»ç»Ÿ_å®Œæ•´æ•°æ®é›†_51ç¯‡.json')
    try:
        with open(output_file, 'w', encoding='utf-8') as f:
            json.dump(unified_articles, f, ensure_ascii=False, indent=2)
        print(f"\nâœ… ç»Ÿä¸€æ•°æ®é›†ä¿å­˜æˆåŠŸ: {output_file}")
        
        # æ˜¾ç¤ºæ–‡ä»¶å¤§å°
        file_size = os.path.getsize(output_file) / 1024
        print(f"   æ–‡ä»¶å¤§å°: {file_size:.1f} KB")
        
        return True
        
    except Exception as e:
        print(f"âŒ ä¿å­˜ç»Ÿä¸€æ•°æ®é›†å¤±è´¥: {e}")
        return False

def analyze_unified_dataset():
    """åˆ†æç»Ÿä¸€æ•°æ®é›†çš„åˆ†å¸ƒ"""
    output_file = os.path.join(os.path.dirname(__file__), 'ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒä¿¡æ¯é—¨æˆ·ç³»ç»Ÿ_å®Œæ•´æ•°æ®é›†_51ç¯‡.json')
    if not os.path.exists(output_file):
        print("âŒ ç»Ÿä¸€æ•°æ®é›†æ–‡ä»¶ä¸å­˜åœ¨")
        return
    
    try:
        with open(output_file, 'r', encoding='utf-8') as f:
            articles = json.load(f)
        
        print(f"\nğŸ“ˆ æ•°æ®é›†åˆ†æ (æ€»è®¡{len(articles)}ç¯‡):")
        print("=" * 60)
        
        # åˆ†ææ–‡æ¡£ç±»å‹åˆ†å¸ƒ
        doc_types = {}
        for article in articles:
            doc_type = article.get('æ–‡æ¡£ç±»å‹', 'æœªçŸ¥')
            doc_types[doc_type] = doc_types.get(doc_type, 0) + 1
        
        print("ğŸ“‹ æ–‡æ¡£ç±»å‹åˆ†å¸ƒ:")
        for doc_type, count in sorted(doc_types.items(), key=lambda x: x[1], reverse=True):
            percentage = count / len(articles) * 100
            print(f"   {doc_type}: {count}ç¯‡ ({percentage:.1f}%)")
        
        # åˆ†æèƒ½æºç±»å‹åˆ†å¸ƒ
        energy_types = {}
        for article in articles:
            energy_tags = article.get('èƒ½æºå“ç§æ ‡ç­¾', [])
            if isinstance(energy_tags, str):
                # ç®€å•è§£æå­—ç¬¦ä¸²æ ¼å¼
                import ast
                try:
                    energy_tags = ast.literal_eval(energy_tags)
                except:
                    energy_tags = []
            
            for energy_type in energy_tags:
                energy_types[energy_type] = energy_types.get(energy_type, 0) + 1
        
        print("\nâš¡ èƒ½æºç±»å‹åˆ†å¸ƒ:")
        for energy_type, count in sorted(energy_types.items(), key=lambda x: x[1], reverse=True):
            percentage = count / len(articles) * 100
            print(f"   {energy_type}: {count}ç¯‡ ({percentage:.1f}%)")
        
        # åˆ†æå‘å¸ƒæ—¶é—´åˆ†å¸ƒ
        years = {}
        for article in articles:
            publish_time = article.get('å‘å¸ƒæ—¶é—´', '')
            if publish_time:
                year = publish_time[:4] if len(publish_time) >= 4 else 'æœªçŸ¥'
                years[year] = years.get(year, 0) + 1
        
        print("\nğŸ“… å‘å¸ƒå¹´ä»½åˆ†å¸ƒ:")
        for year, count in sorted(years.items()):
            percentage = count / len(articles) * 100
            print(f"   {year}å¹´: {count}ç¯‡ ({percentage:.1f}%)")
            
    except Exception as e:
        print(f"âŒ åˆ†ææ•°æ®é›†å¤±è´¥: {e}")

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸš€ ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒä¿¡æ¯é—¨æˆ·ç³»ç»Ÿ - ç»Ÿä¸€æ•°æ®é›†åˆ›å»ºå·¥å…·")
    print("=" * 80)
    
    # åˆ›å»ºç»Ÿä¸€æ•°æ®é›†
    success = create_unified_dataset()
    if not success:
        print("\nâŒ ç»Ÿä¸€æ•°æ®é›†åˆ›å»ºå¤±è´¥")
        return
    
    # åˆ†ææ•°æ®é›†
    analyze_unified_dataset()
    
    print("\n" + "=" * 80)
    print("ğŸ‰ ç»Ÿä¸€æ•°æ®é›†åˆ›å»ºå®Œæˆï¼")
    print("\nâœ… ä¸»è¦æˆæœ:")
    print("   1. æ•´åˆv1ç‰ˆæœ¬45ç¯‡ + v2ç‰ˆæœ¬6ç¯‡ = å®Œæ•´51ç¯‡æ–‡ç« ")
    print("   2. æ¶ˆé™¤äº†ç‰ˆæœ¬é—´çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜")
    print("   3. ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼Œä¾¿äºç»´æŠ¤")
    print("   4. ç”Ÿæˆè´¨é‡æ£€æŸ¥æŠ¥å‘Š")
    print("\nğŸ“„ è¾“å‡ºæ–‡ä»¶: ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒä¿¡æ¯é—¨æˆ·ç³»ç»Ÿ_å®Œæ•´æ•°æ®é›†_51ç¯‡.json")
    print("ğŸ“ ä¸‹ä¸€æ­¥: æ›´æ–°import_sample_data.pyä½¿ç”¨æ–°çš„ç»Ÿä¸€æ•°æ®é›†")

if __name__ == "__main__":
    main() 