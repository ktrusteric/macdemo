#!/usr/bin/env python3
"""
å¯¼å…¥v2ç‰ˆæœ¬å†…å®¹æ•°æ®åˆ°æ•°æ®åº“
åŸºäºä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒç½‘ç«™æœ€æ–°å†…å®¹
"""

import asyncio
import sys
import os
from datetime import datetime
sys.path.append(os.path.dirname(os.path.dirname(__file__)))

from motor.motor_asyncio import AsyncIOMotorClient
from app.core.config import settings
from app.models.content import ContentType

# v2ç‰ˆæœ¬æ•°æ®
V2_CONTENT_DATA = [
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "å¯†é›†æŠ•äº§æ½®ä¸‹åˆ©ç”¨ç‡ä¸è¶³50%ï¼ŒLNGæ¥æ”¶ç«™å¸‚åœºç«äº‰åŠ å‰§ï¼Œå¦‚ä½•ä¿éšœæ•ˆç›Š",
        "content": "éšç€å…¨çƒLNGè´¸æ˜“é‡æŒç»­å¢é•¿ï¼Œä¸­å›½LNGæ¥æ”¶ç«™å»ºè®¾è¿›å…¥å¯†é›†æŠ•äº§æœŸã€‚ç„¶è€Œï¼Œå—å¸‚åœºä¾›éœ€å˜åŒ–å½±å“ï¼Œéƒ¨åˆ†æ¥æ”¶ç«™åˆ©ç”¨ç‡ä¸è¶³50%ï¼Œé¢ä¸´ä¸¥å³»çš„å¸‚åœºç«äº‰å‹åŠ›ã€‚è¡Œä¸šä¸“å®¶æŒ‡å‡ºï¼Œæ¥æ”¶ç«™è¿è¥å•†éœ€è¦é€šè¿‡æŠ€æœ¯å‡çº§ã€æœåŠ¡ä¼˜åŒ–ã€å•†ä¸šæ¨¡å¼åˆ›æ–°ç­‰æ–¹å¼æå‡ç«äº‰åŠ›ï¼Œç¡®ä¿æŠ•èµ„æ•ˆç›Šã€‚æœªæ¥LNGæ¥æ”¶ç«™å‘å±•éœ€è¦ç»Ÿç­¹è§„åˆ’ï¼Œé¿å…é‡å¤å»ºè®¾ï¼Œæé«˜æ•´ä½“åˆ©ç”¨æ•ˆç‡ã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-30",
        "link": "https://www.shpgx.com/html/xyzx/20250530/7850.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
        "region_tags": ["ä¸­å›½", "å…¨å›½"],
        "business_field_tags": ["æ¥æ”¶ç«™è¿è¥", "å¸‚åœºç«äº‰", "æŠ•èµ„æ•ˆç›Š"],
        "beneficiary_tags": ["LNGè¿è¥å•†", "èƒ½æºä¼ä¸š"],
        "policy_measure_tags": ["æŠ€æœ¯å‡çº§", "å•†ä¸šæ¨¡å¼åˆ›æ–°"],
        "importance_tags": ["è¡Œä¸šçº§"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "æ–°å¥¥è‚¡ä»½é‡å¤§èµ„äº§é‡ç»„è·è‚¡ä¸œå¤§ä¼šè¶…99.9%é«˜ç¥¨é€šè¿‡ï¼Œå¤©ç„¶æ°”äº§ä¸šé“¾ä¸€ä½“åŒ–æˆ˜ç•¥å–å¾—å…³é”®è¿›å±•",
        "content": "æ–°å¥¥è‚¡ä»½é‡å¤§èµ„äº§é‡ç»„æ–¹æ¡ˆè·å¾—è‚¡ä¸œå¤§ä¼šè¶…99.9%çš„é«˜ç¥¨é€šè¿‡ï¼Œæ ‡å¿—ç€å…¬å¸å¤©ç„¶æ°”äº§ä¸šé“¾ä¸€ä½“åŒ–æˆ˜ç•¥å–å¾—å…³é”®æ€§è¿›å±•ã€‚æ­¤æ¬¡é‡ç»„å°†è¿›ä¸€æ­¥å®Œå–„æ–°å¥¥åœ¨å¤©ç„¶æ°”å…¨äº§ä¸šé“¾çš„å¸ƒå±€ï¼Œæå‡å…¬å¸åœ¨LNGè´¸æ˜“ã€ç»ˆç«¯é”€å”®ç­‰å…³é”®ç¯èŠ‚çš„ç«äº‰ä¼˜åŠ¿ã€‚å¸‚åœºåˆ†æè®¤ä¸ºï¼Œè¿™ä¸€ä¸¾æªå°†æœ‰åŠ©äºæ–°å¥¥è‚¡ä»½å®ç°è§„æ¨¡åŒ–å‘å±•ï¼Œæé«˜æŠ—é£é™©èƒ½åŠ›ã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-30",
        "link": "https://www.shpgx.com/html/xyzx/20250530/7849.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["å¤©ç„¶æ°”", "æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
        "region_tags": ["ä¸­å›½", "å…¨å›½"],
        "business_field_tags": ["èµ„äº§é‡ç»„", "äº§ä¸šé“¾ä¸€ä½“åŒ–", "LNGè´¸æ˜“"],
        "beneficiary_tags": ["æ–°å¥¥è‚¡ä»½", "ä¸Šå¸‚å…¬å¸", "èƒ½æºä¼ä¸š"],
        "policy_measure_tags": ["èµ„äº§é‡ç»„", "äº§ä¸šé“¾æ•´åˆ"],
        "importance_tags": ["è¡Œä¸šçº§"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "ä¸­å›½çŸ³æ²¹å‘å¸ƒ3000äº¿å‚æ•°æ˜†ä»‘å¤§æ¨¡å‹",
        "content": "ä¸­å›½çŸ³æ²¹æ­£å¼å‘å¸ƒ3000äº¿å‚æ•°è§„æ¨¡çš„æ˜†ä»‘å¤§æ¨¡å‹ï¼Œè¿™æ˜¯çŸ³æ²¹å¤©ç„¶æ°”è¡Œä¸šé¦–ä¸ªåƒäº¿çº§å‚æ•°å¤§æ¨¡å‹ã€‚è¯¥æ¨¡å‹å°†åœ¨å‹˜æ¢å¼€å‘ã€ç‚¼åŒ–ç”Ÿäº§ã€é”€å”®æœåŠ¡ç­‰å¤šä¸ªä¸šåŠ¡åœºæ™¯ä¸­åº”ç”¨ï¼Œé€šè¿‡AIæŠ€æœ¯æå‡ä½œä¸šæ•ˆç‡å’Œå†³ç­–æ°´å¹³ã€‚ä¸“å®¶è¡¨ç¤ºï¼Œå¤§æ¨¡å‹æŠ€æœ¯çš„åº”ç”¨å°†æ¨åŠ¨ä¼ ç»Ÿèƒ½æºè¡Œä¸šæ•°å­—åŒ–è½¬å‹ï¼Œä¸ºè¡Œä¸šå‘å±•æ³¨å…¥æ–°åŠ¨èƒ½ã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-30",
        "link": "https://www.shpgx.com/html/xyzx/20250530/7848.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["çŸ³æ²¹", "å¤©ç„¶æ°”"],
        "region_tags": ["ä¸­å›½", "å…¨å›½"],
        "business_field_tags": ["äººå·¥æ™ºèƒ½", "æ•°å­—åŒ–è½¬å‹", "æŠ€æœ¯åˆ›æ–°"],
        "beneficiary_tags": ["ä¸­å›½çŸ³æ²¹", "èƒ½æºä¼ä¸š", "æŠ€æœ¯å…¬å¸"],
        "policy_measure_tags": ["æŠ€æœ¯åˆ›æ–°", "AIåº”ç”¨", "æ•°å­—åŒ–å‡çº§"],
        "importance_tags": ["è¡Œä¸šçº§", "æŠ€æœ¯çªç ´"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "5æœˆ19æ—¥-25æ—¥ä¸­å›½LNGç»¼åˆè¿›å£åˆ°å²¸ä»·æ ¼æŒ‡æ•°ä¸º131.78ç‚¹",
        "content": "5æœˆ19æ—¥-25æ—¥å½“å‘¨ï¼Œä¸­å›½LNGç»¼åˆè¿›å£åˆ°å²¸ä»·æ ¼æŒ‡æ•°ä¸º131.78ç‚¹ï¼Œä»·æ ¼ç›¸å¯¹ç¨³å®šã€‚éšç€å¤å­£ç”¨æ°”éœ€æ±‚é€æ­¥å‡å°‘ï¼ŒLNGå¸‚åœºä¾›éœ€è¶‹äºå¹³è¡¡ã€‚ä¸šå†…åˆ†æè®¤ä¸ºï¼ŒäºŒå­£åº¦LNGä»·æ ¼å°†ä¿æŒç›¸å¯¹å¹³ç¨³ï¼Œä½†éœ€å…³æ³¨å›½é™…å¸‚åœºä¾›åº”ç«¯å˜åŒ–å’Œä¸‹åŠå¹´å†¬å­£å¤‡è´§éœ€æ±‚ã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-29",
        "link": "https://www.shpgx.com/html/xyzx/20250529/7845.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)"],
        "region_tags": ["ä¸­å›½", "å…¨å›½"],
        "business_field_tags": ["ä»·æ ¼æŒ‡æ•°", "è¿›å£è´¸æ˜“", "å¸‚åœºåˆ†æ"],
        "beneficiary_tags": ["LNGè´¸æ˜“å•†", "åŸå¸‚ç‡ƒæ°”å…¬å¸", "èƒ½æºä¼ä¸š"],
        "policy_measure_tags": ["ä»·æ ¼ç›‘æµ‹", "ä¾›éœ€è°ƒèŠ‚"],
        "importance_tags": ["å¸‚åœºçº§"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "å¤§æ¸¯æ²¹ç”°å‚¨æ°”åº“ç¾¤åŠ å¿«æ‰©å®¹ ä¸ºäº¬æ´¥å†€å†¬å­£ä¿ä¾›è“„èƒ½",
        "content": "å¤§æ¸¯æ²¹ç”°å‚¨æ°”åº“ç¾¤æ­£åœ¨åŠ å¿«æ‰©å®¹å»ºè®¾ï¼Œä¸ºå³å°†åˆ°æ¥çš„å†¬å­£å¤©ç„¶æ°”ä¿ä¾›åšå¥½å‡†å¤‡ã€‚ä½œä¸ºååŒ—åœ°åŒºé‡è¦çš„å¤©ç„¶æ°”å‚¨å¤‡åŸºåœ°ï¼Œå¤§æ¸¯å‚¨æ°”åº“ç¾¤æ‰¿æ‹…ç€äº¬æ´¥å†€åœ°åŒºå†¬å­£è°ƒå³°ä¿ä¾›çš„é‡è¦ä»»åŠ¡ã€‚é¢„è®¡æ–°å¢å‚¨æ°”èƒ½åŠ›å°†æœ‰æ•ˆç¼“è§£å†¬å­£ç”¨æ°”ç´§å¼ å±€é¢ï¼Œä¸ºåŒºåŸŸèƒ½æºå®‰å…¨æä¾›åšå®ä¿éšœã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-29",
        "link": "https://www.shpgx.com/html/xyzx/20250529/7844.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["å¤©ç„¶æ°”"],
        "region_tags": ["åŒ—äº¬", "å¤©æ´¥", "æ²³åŒ—", "ååŒ—åœ°åŒº", "äº¬æ´¥å†€"],
        "business_field_tags": ["å‚¨æ°”åº“", "å†¬å­£ä¿ä¾›", "è°ƒå³°å‚¨å¤‡", "åŸºç¡€è®¾æ–½"],
        "beneficiary_tags": ["äº¬æ´¥å†€ç”¨æˆ·", "åŸå¸‚ç‡ƒæ°”å…¬å¸", "èƒ½æºä¼ä¸š"],
        "policy_measure_tags": ["å‚¨æ°”åº“å»ºè®¾", "ä¿ä¾›æªæ–½", "åŸºç¡€è®¾æ–½æŠ•èµ„"],
        "importance_tags": ["åŒºåŸŸçº§", "æ°‘ç”Ÿä¿éšœ"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "éæ´²æ¸æˆLNGä¾›åº”æ–°ä¸»åŠ›",
        "content": "éšç€å…¨çƒLNGéœ€æ±‚æŒç»­å¢é•¿ï¼Œéæ´²æ­£é€æ¸æˆä¸ºLNGä¾›åº”çš„æ–°ä¸»åŠ›ã€‚å°¼æ—¥åˆ©äºšã€è«æ¡‘æ¯”å…‹ã€å¦æ¡‘å°¼äºšç­‰éæ´²å›½å®¶æ‹¥æœ‰ä¸°å¯Œçš„å¤©ç„¶æ°”èµ„æºï¼Œæ­£åœ¨å¤§åŠ›å‘å±•LNGå‡ºå£é¡¹ç›®ã€‚åˆ†æå¸ˆé¢„è®¡ï¼Œæœªæ¥5å¹´éæ´²LNGäº§èƒ½å°†æ˜¾è‘—å¢é•¿ï¼Œä¸ºå…¨çƒLNGå¸‚åœºä¾›åº”å¤šå…ƒåŒ–åšå‡ºé‡è¦è´¡çŒ®ã€‚ä¸­å›½ä¼ä¸šä¹Ÿç§¯æå‚ä¸éæ´²LNGé¡¹ç›®å¼€å‘ã€‚",
        "type": "news",
        "source": "ä¸Šæµ·çŸ³æ²¹å¤©ç„¶æ°”äº¤æ˜“ä¸­å¿ƒ",
        "publish_time": "2025-05-28",
        "link": "https://www.shpgx.com/html/xyzx/20250528/7840.html",
        "basic_info_tags": ["è¡Œä¸šèµ„è®¯"],
        "energy_type_tags": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)", "å¤©ç„¶æ°”"],
        "region_tags": ["éæ´²", "å°¼æ—¥åˆ©äºš", "è«æ¡‘æ¯”å…‹", "å¦æ¡‘å°¼äºš", "å›½é™…"],
        "business_field_tags": ["LNGå‡ºå£", "ä¾›åº”æ ¼å±€", "èµ„æºå¼€å‘", "å›½é™…è´¸æ˜“"],
        "beneficiary_tags": ["éæ´²å›½å®¶", "LNGç”Ÿäº§å•†", "ä¸­å›½ä¼ä¸š"],
        "policy_measure_tags": ["èµ„æºå¼€å‘", "å›½é™…åˆä½œ", "é¡¹ç›®æŠ•èµ„"],
        "importance_tags": ["å›½é™…çº§"]
    },
    # æ”¿ç­–æ³•è§„å†…å®¹
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "å›½å®¶èƒ½æºå±€å…³äºä¿ƒè¿›èƒ½æºé¢†åŸŸæ°‘è¥ç»æµå‘å±•è‹¥å¹²ä¸¾æªçš„é€šçŸ¥",
        "content": "å›½å®¶èƒ½æºå±€å…³äºä¿ƒè¿›èƒ½æºé¢†åŸŸæ°‘è¥ç»æµå‘å±•è‹¥å¹²ä¸¾æªçš„é€šçŸ¥ã€‚ä¸ºæ·±å…¥è´¯å½»è½å®ä¹ è¿‘å¹³æ€»ä¹¦è®°åœ¨æ°‘è¥ä¼ä¸šåº§è°ˆä¼šä¸Šçš„é‡è¦è®²è¯ç²¾ç¥ï¼Œä¿ƒè¿›èƒ½æºé¢†åŸŸæ°‘è¥ç»æµåŠ å¿«å‘å±•ï¼Œå¼•å¯¼æ°‘è¥ç»æµåœ¨æ¨è¿›èƒ½æºç»¿è‰²ä½ç¢³è½¬å‹å’Œå»ºè®¾æ–°å‹èƒ½æºä½“ç³»ä¸­åšå¤§åšä¼˜åšå¼ºã€‚æ”¯æŒæ°‘è¥ä¼ä¸šå‚è‚¡æŠ•èµ„æ ¸ç”µé¡¹ç›®ï¼ŒæŠ•èµ„å»ºè®¾æ°´ç”µã€æ²¹æ°”å‚¨å¤‡è®¾æ–½ã€æ¶²åŒ–å¤©ç„¶æ°”æ¥æ”¶ç«™ç­‰åŸºç¡€è®¾æ–½é¡¹ç›®ã€‚",
        "type": "policy",
        "source": "å›½å®¶èƒ½æºå±€",
        "publish_time": "2025-04-30",
        "link": "https://www.shpgx.com/html/zcsd/20250430/7765.html",
        "basic_info_tags": ["æ”¿ç­–æ³•è§„"],
        "energy_type_tags": ["æ¶²åŒ–å¤©ç„¶æ°”(LNG)", "å¤©ç„¶æ°”", "ç”µåŠ›", "æ ¸ç”µ"],
        "region_tags": ["å…¨å›½"],
        "business_field_tags": ["æ°‘è¥ç»æµå‘å±•", "å¸‚åœºå‡†å…¥ä¼˜åŒ–", "æŠ•èµ„æ”¯æŒ", "ç§‘æŠ€åˆ›æ–°"],
        "beneficiary_tags": ["æ°‘è¥ä¼ä¸š"],
        "policy_measure_tags": ["æŠ•èµ„æ”¯æŒ", "å¸‚åœºå‡†å…¥æªæ–½", "ç§‘æŠ€åˆ›æ–°"],
        "importance_tags": ["å›½å®¶çº§", "é‡è¦æ”¿ç­–"]
    },
    {
        "ç‰ˆæœ¬": "v2",
        "æ ‡é¢˜": "ä¸Šæµ·å¸‚å‘å±•å’Œæ”¹é©å§”å‘˜ä¼šï¼šå…³äºæ ¸å®šæœ¬å¸‚ç®¡é“å¤©ç„¶æ°”é…æ°”ä»·æ ¼åŠä¸Šæµ·å¤©ç„¶æ°”ç®¡ç½‘æœ‰é™å…¬å¸ç®¡è¾“ä»·æ ¼çš„é€šçŸ¥",
        "content": "æŒ‰ç…§å›½å®¶å‘å±•æ”¹é©å§”ç›¸å…³è§„å®šï¼Œæ ¹æ®æˆæœ¬ç›‘å®¡æƒ…å†µï¼Œç»“åˆæœ¬å¸‚å®é™…ï¼Œç°å°±æœ¬å¸‚ç®¡é“å¤©ç„¶æ°”é…æ°”ä»·æ ¼åŠä¸Šæµ·å¤©ç„¶æ°”ç®¡ç½‘æœ‰é™å…¬å¸ç®¡è¾“ä»·æ ¼ç­‰æœ‰å…³äº‹é¡¹é€šçŸ¥ã€‚æœ¬å¸‚ç®¡é“å¤©ç„¶æ°”ç»¼åˆé…æ°”ä»·æ ¼æ ¸å®šä¸º0.41å…ƒ/ç«‹æ–¹ç±³ï¼ˆå«ç¨ï¼‰ã€‚ç®¡è¾“ä»·æ ¼æ ¸å®šä¸º0.12å…ƒ/ç«‹æ–¹ç±³ï¼ˆå«ç¨ï¼‰ã€‚",
        "type": "policy",
        "source": "ä¸Šæµ·å¸‚å‘å±•å’Œæ”¹é©å§”å‘˜ä¼š",
        "publish_time": "2025-04-28",
        "link": "https://www.shpgx.com/html/zcsd/20250428/7757.html",
        "basic_info_tags": ["æ”¿ç­–æ³•è§„"],
        "energy_type_tags": ["ç®¡é“å¤©ç„¶æ°”(PNG)", "å¤©ç„¶æ°”"],
        "region_tags": ["ä¸Šæµ·", "ä¸Šæµ·å¸‚", "åä¸œåœ°åŒº"],
        "business_field_tags": ["ä»·æ ¼æ”¿ç­–", "é…æ°”ä»·æ ¼", "ç®¡è¾“ä»·æ ¼", "æˆæœ¬ç›‘å®¡"],
        "beneficiary_tags": ["ç®¡é“ç‡ƒæ°”ä¼ä¸š", "å¤©ç„¶æ°”ç”¨æˆ·"],
        "policy_measure_tags": ["ä»·æ ¼æ ¸å®š", "æˆæœ¬ç›‘å®¡", "æ”¿åºœå®šä»·"],
        "importance_tags": ["çœçº§", "ä»·æ ¼æ”¿ç­–"]
    }
]

async def import_v2_content():
    """å¯¼å…¥v2ç‰ˆæœ¬å†…å®¹æ•°æ®"""
    client = None
    try:
        client = AsyncIOMotorClient(settings.MONGODB_URL)
        db = client[settings.DATABASE_NAME]
        collection = db.content
        
        print("ğŸš€ å¼€å§‹å¯¼å…¥v2ç‰ˆæœ¬å†…å®¹æ•°æ®...")
        
        imported_count = 0
        for article_data in V2_CONTENT_DATA:
            # è½¬æ¢ä¸ºæ•°æ®åº“æ ¼å¼
            db_article = {
                "title": article_data["æ ‡é¢˜"],
                "content": article_data["content"],
                "type": article_data["type"],
                "source": article_data["source"],
                "publish_time": article_data["publish_time"],
                "link": article_data["link"],
                "basic_info_tags": article_data["basic_info_tags"],
                "energy_type_tags": article_data["energy_type_tags"],
                "region_tags": article_data["region_tags"],
                "business_field_tags": article_data["business_field_tags"],
                "beneficiary_tags": article_data["beneficiary_tags"],
                "policy_measure_tags": article_data["policy_measure_tags"],
                "importance_tags": article_data["importance_tags"],
                "version": "v2",  # æ ‡è®°ä¸ºv2ç‰ˆæœ¬
                "created_at": datetime.now(),
                "updated_at": datetime.now()
            }
            
            # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒæ ‡é¢˜çš„æ–‡ç« 
            existing = await collection.find_one({"title": db_article["title"]})
            if not existing:
                await collection.insert_one(db_article)
                imported_count += 1
                print(f"âœ… å¯¼å…¥æ–‡ç« : {db_article['title'][:50]}...")
            else:
                print(f"âš ï¸  æ–‡ç« å·²å­˜åœ¨ï¼Œè·³è¿‡: {db_article['title'][:50]}...")
        
        # ç»Ÿè®¡éªŒè¯
        total_v1 = await collection.count_documents({"version": {"$ne": "v2"}})
        total_v2 = await collection.count_documents({"version": "v2"})
        total_all = await collection.count_documents({})
        
        print(f"\nğŸ“Š å¯¼å…¥å®Œæˆç»Ÿè®¡:")
        print(f"   æœ¬æ¬¡å¯¼å…¥: {imported_count} ç¯‡")
        print(f"   v1ç‰ˆæœ¬æ–‡ç« : {total_v1} ç¯‡")
        print(f"   v2ç‰ˆæœ¬æ–‡ç« : {total_v2} ç¯‡")
        print(f"   æ€»æ–‡ç« æ•°: {total_all} ç¯‡")
        
        # æŒ‰ç±»å‹ç»Ÿè®¡v2ç‰ˆæœ¬
        news_count = await collection.count_documents({"version": "v2", "basic_info_tags": "è¡Œä¸šèµ„è®¯"})
        policy_count = await collection.count_documents({"version": "v2", "basic_info_tags": "æ”¿ç­–æ³•è§„"})
        
        print(f"\nğŸ“ˆ v2ç‰ˆæœ¬åˆ†ç±»ç»Ÿè®¡:")
        print(f"   è¡Œä¸šèµ„è®¯: {news_count} ç¯‡")
        print(f"   æ”¿ç­–æ³•è§„: {policy_count} ç¯‡")
        
    except Exception as e:
        print(f"âŒ å¯¼å…¥å¤±è´¥: {e}")
        import traceback
        traceback.print_exc()
    finally:
        if client:
            client.close()

if __name__ == "__main__":
    asyncio.run(import_v2_content()) 